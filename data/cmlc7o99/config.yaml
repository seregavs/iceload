cmlc7o99:
  key_fields: mat_doc, doc_year, mat_item, stocktype
  key_fields_create: mat_doc STRING NOT NULL, doc_year STRING NOT NULL, mat_item STRING  NOT NULL, stocktype STRING  NOT NULL
  add_identifier: False
  srcformat: parquet
  database: db
  dstype: adso-std
  table_name: dwh_t_cmlc7o99
  srcfiles: |
    {"f": "/home/alpine/iceload/data/cmlc7o99/cmlc70993_20241220.parquet"}
  src_table_name: stg_t_cmlc7o99
  iceberg_tbl_props: iceberg_tbl_props_01
  create_table:
    recordmode STRING, 
    mat_doc STRING  NOT NULL, 
    doc_year STRING  NOT NULL, 
    mat_item STRING  NOT NULL, 
    stocktype STRING  NOT NULL, 
    pstng_date DATE, 
    doc_date DATE, 
    material STRING  NOT NULL, 
    dcindic STRING  NOT NULL, 
    stor_loc STRING  NOT NULL, 
    plant STRING  NOT NULL, 
    sold_to STRING  NOT NULL, 
    vendor STRING  NOT NULL, 
    inv_pty STRING  NOT NULL, 
    comp_code STRING  NOT NULL, 
    cordd_num STRING  NOT NULL, 
    cordd_it STRING  NOT NULL, 
    move_type STRING  NOT NULL, 
    ref_doc_no STRING  NOT NULL, 
    move_plant STRING  NOT NULL, 
    account STRING  NOT NULL, 
    chrt_accts STRING  NOT NULL, 
    costcenter STRING  NOT NULL, 
    co_area STRING  NOT NULL, 
    loc_currcy STRING  NOT NULL, 
    value_lc DECIMAL(17,2), 
    quant_b DECIMAL(17,3), 
    base_uom STRING  NOT NULL, 
    storno STRING  NOT NULL, 
    deliv_numb STRING  NOT NULL, 
    deliv_item STRING  NOT NULL, 
    createdon STRING, 
    zbolnr STRING  NOT NULL, 
    zlifex STRING  NOT NULL, 
    zverur STRING  NOT NULL, 
    gi_date STRING, 
    zcompldat STRING  NOT NULL, 
    zdistprof STRING  NOT NULL, 
    zaltcost DECIMAL(17,2), 
    username STRING  NOT NULL, 
    zmatmrea STRING  NOT NULL, 
    processkey STRING  NOT NULL, 
    bwapplnm STRING  NOT NULL, 
    valspecst STRING  NOT NULL, 
    stockcat STRING  NOT NULL, 
    stockrelev STRING  NOT NULL, 
    cppvlc DECIMAL(17,2), 
    cpquabu DECIMAL(17,3), 
    zsgtxt STRING  NOT NULL, 
    zicomargn DECIMAL(17,2)
  partition: month(pstng_date)
  views: 12
  insert_table: |
    recordmode,
    mat_doc,
    doc_year,
    mat_item,
    stocktype,
    pstng_date,
    doc_date,
    material,
    dcindic,
    stor_loc,
    plant,
    sold_to,
    vendor,
    inv_pty,
    comp_code,
    cordd_num,
    cordd_it,
    move_type,
    ref_doc_no,
    move_plant,
    account,
    chrt_accts,
    costcenter,
    co_area,
    loc_currcy,
    value_lc,
    quant_b,
    base_uom,
    storno,
    deliv_numb,
    deliv_item,
    createdon,
    zbolnr,
    zlifex,
    zverur,
    gi_date,
    zcompldat,
    zdistprof,
    zaltcost,
    username,
    zmatmrea,
    processkey,
    bwapplnm,
    valspecst,
    stockcat,
    stockrelev,
    cppvlc,
    cpquabu,
    zsgtxt,
    zicomargn
  insert_values: |
    recordmode,
    ifnull(mat_doc,chr(0)),
    ifnull(doc_year,chr(0)),
    ifnull(mat_item,chr(0)),
    ifnull(stocktype,chr(0)),
    to_date(pstng_date, 'yyyyMMdd'),
    to_date(doc_date, 'yyyyMMdd'),
    ifnull(material,chr(0)),
    ifnull(dcindic,chr(0)),
    ifnull(stor_loc,chr(0)),
    ifnull(plant,chr(0)),
    ifnull(sold_to,chr(0)),
    ifnull(vendor,chr(0)),
    ifnull(inv_pty,chr(0)),
    ifnull(comp_code,chr(0)),
    ifnull(cordd_num,chr(0)),
    ifnull(cordd_it,chr(0)),
    ifnull(move_type,chr(0)),
    ifnull(ref_doc_no,chr(0)),
    ifnull(move_plant,chr(0)),
    ifnull(account,chr(0)),
    ifnull(chrt_accts,chr(0)),
    ifnull(costcenter,chr(0)),
    ifnull(co_area,chr(0)),
    ifnull(loc_currcy,chr(0)),
    CAST(value_lc AS DECIMAL(17,2)),
    CAST(quant_b AS DECIMAL(17,3)),
    ifnull(base_uom,chr(0)),
    ifnull(storno,chr(0)),
    ifnull(deliv_numb,chr(0)),
    ifnull(deliv_item,chr(0)),
    createdon,
    ifnull(zbolnr,chr(0)),
    ifnull(zlifex,chr(0)),
    ifnull(zverur,chr(0)),
    gi_date,
    zcompldat,
    ifnull(zdistprof,chr(0)),
    CAST(zaltcost AS DECIMAL(17,2)),
    ifnull(username,chr(0)),
    ifnull(zmatmrea,chr(0)),
    ifnull(processkey,chr(0)),
    ifnull(bwapplnm,chr(0)),
    ifnull(valspecst,chr(0)),
    ifnull(stockcat,chr(0)),
    ifnull(stockrelev,chr(0)),
    CAST(cppvlc AS DECIMAL(17,2)),
    CAST(cpquabu AS DECIMAL(17,3)),
    ifnull(zsgtxt,chr(0)),
    CAST(zicomargn AS DECIMAL(17,2))
  merge:
    ON target.mat_doc = source.mat_doc 
    AND target.doc_year = source.doc_year
    AND target.mat_item = source.mat_item
    AND target.stocktype = source.stocktype
    WHEN MATCHED AND source.recordmode = NULL THEN 
    UPDATE SET 
      target.pstng_date = to_date(source.pstng_date, 'yyyyMMdd'),
      target.doc_date = to_date(source.doc_date, 'yyyyMMdd'),
      target.material = source.material,
      target.dcindic = source.dcindic,
      target.stor_loc = source.stor_loc,
      target.plant = source.plant,
      target.sold_to = source.sold_to,
      target.vendor = source.vendor,
      target.inv_pty = source.inv_pty,
      target.comp_code = source.comp_code,
      target.cordd_num = source.cordd_num,
      target.cordd_it = source.cordd_it,
      target.move_type = source.move_type,
      target.ref_doc_no = source.ref_doc_no,
      target.move_plant = source.move_plant,
      target.account = source.account,
      target.chrt_accts = source.chrt_accts,
      target.costcenter = source.costcenter,
      target.co_area = source.co_area,
      target.loc_currcy = source.loc_currcy,
      target.value_lc = CAST(source.value_lc AS DECIMAL(17,2)),
      target.quant_b = CAST(source.quant_b AS DECIMAL(17,3)),
      target.base_uom = source.base_uom,
      target.storno = source.storno,
      target.deliv_numb = source.deliv_numb,
      target.deliv_item = source.deliv_item,
      target.createdon = source.createdon,
      target.zbolnr = source.zbolnr,
      target.zlifex = source.zlifex,
      target.zverur = source.zverur,
      target.gi_date = source.gi_date,
      target.zcompldat = source.zcompldat,
      target.zdistprof = source.zdistprof,
      target.zaltcost = CAST(source.zaltcost AS DECIMAL(17,2)),
      target.username = source.username,
      target.zmatmrea = source.zmatmrea,
      target.processkey = source.processkey,
      target.bwapplnm = source.bwapplnm,
      target.valspecst = source.valspecst,
      target.stockcat = source.stockcat,
      target.stockrelev = source.stockrelev,
      target.cppvlc = CAST(source.cppvlc AS DECIMAL(17,2)),
      target.cpquabu = CAST(source.cpquabu AS DECIMAL(17,3)),
      target.zsgtxt = source.zsgtxt,
      target.zicomargn = CAST(source.zicomargn AS DECIMAL(17,2))
    WHEN MATCHED AND source.recordmode = 'D' THEN DELETE     
    WHEN NOT MATCHED THEN 
    INSERT (
        mat_doc, 
        doc_year, 
        mat_item, 
        stocktype, 
        pstng_date, 
        doc_date, 
        material, 
        dcindic, 
        stor_loc, 
        plant, 
        sold_to, 
        vendor, 
        inv_pty, 
        comp_code, 
        cordd_num, 
        cordd_it, 
        move_type, 
        ref_doc_no, 
        move_plant, 
        account, 
        chrt_accts, 
        costcenter, 
        co_area, 
        loc_currcy, 
        value_lc, 
        quant_b, 
        base_uom, 
        storno, 
        deliv_numb, 
        deliv_item, 
        createdon, 
        zbolnr, 
        zlifex, 
        zverur, 
        gi_date, 
        zcompldat, 
        zdistprof, 
        zaltcost, 
        username, 
        zmatmrea, 
        processkey, 
        bwapplnm, 
        valspecst, 
        stockcat, 
        stockrelev, 
        cppvlc, 
        cpquabu, 
        zsgtxt, 
        zicomargn
    ) 
    VALUES (
      ifnull(source.mat_doc,chr(0)),
      ifnull(source.doc_year,chr(0)),
      ifnull(source.mat_item,chr(0)),
      ifnull(source.stocktype,chr(0)),
      to_date(source.pstng_date, 'yyyyMMdd'),
      to_date(source.doc_date, 'yyyyMMdd'),
      ifnull(source.material,chr(0)),
      ifnull(source.dcindic,chr(0)),
      ifnull(source.stor_loc,chr(0)),
      ifnull(source.plant,chr(0)),
      ifnull(source.sold_to,chr(0)),
      ifnull(source.vendor,chr(0)),
      ifnull(source.inv_pty,chr(0)),
      ifnull(source.comp_code,chr(0)),
      ifnull(source.cordd_num,chr(0)),
      ifnull(source.cordd_it,chr(0)),
      ifnull(source.move_type,chr(0)),
      ifnull(source.ref_doc_no,chr(0)),
      ifnull(source.move_plant,chr(0)),
      ifnull(source.account,chr(0)),
      ifnull(source.chrt_accts,chr(0)),
      ifnull(source.costcenter,chr(0)),
      ifnull(source.co_area,chr(0)),
      ifnull(source.loc_currcy,chr(0)),
      CAST(source.value_lc AS DECIMAL(17,2)),
      CAST(source.quant_b AS DECIMAL(17,3)),
      ifnull(source.base_uom,chr(0)),
      ifnull(source.storno,chr(0)),
      ifnull(source.deliv_numb,chr(0)),
      ifnull(source.deliv_item,chr(0)),
      source.createdon,
      ifnull(source.zbolnr,chr(0)),
      ifnull(source.zlifex,chr(0)),
      ifnull(source.zverur,chr(0)),
      source.gi_date,
      source.zcompldat,
      ifnull(source.zdistprof,chr(0)),
      CAST(source.zaltcost AS DECIMAL(17,2)),
      ifnull(source.username,chr(0)),
      ifnull(source.zmatmrea,chr(0)),
      ifnull(source.processkey,chr(0)),
      ifnull(source.bwapplnm,chr(0)),
      ifnull(source.valspecst,chr(0)),
      ifnull(source.stockcat,chr(0)),
      ifnull(source.stockrelev,chr(0)),
      CAST(source.cppvlc AS DECIMAL(17,2)),
      CAST(source.cpquabu AS DECIMAL(17,3)),
      ifnull(source.zsgtxt,chr(0)),
      CAST(source.zicomargn AS DECIMAL(17,2))
    )